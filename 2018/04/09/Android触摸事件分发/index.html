<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Android触摸事件分发"><meta name="keywords" content="Android"><meta name="author" content="Leo-Wxy"><meta name="copyright" content="Leo-Wxy"><title>Android触摸事件分发 | Wxy的个人博客</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-触摸事件的类型"><span class="toc-number">1.</span> <span class="toc-text">1.触摸事件的类型</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-事件传递的三个阶段"><span class="toc-number">2.</span> <span class="toc-text">2.事件传递的三个阶段</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-View的事件传递机制"><span class="toc-number">3.</span> <span class="toc-text">3.View的事件传递机制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-ViewGroup事件传递机制"><span class="toc-number">4.</span> <span class="toc-text">4.ViewGroup事件传递机制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-源码分析"><span class="toc-number">5.</span> <span class="toc-text">5.源码分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-实例分析"><span class="toc-number">6.</span> <span class="toc-text">6.实例分析</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/images/avatar.png"></div><div class="author-info__name text-center">Leo-Wxy</div><div class="author-info__description text-center">如果我没有见过光明，那我本可以忍受黑暗</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">128</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">19</span></a></div></div></div><div id="content-outer"><div class="plain" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Wxy的个人博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">首页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div></div><div class="layout" id="content-inner"><article id="post"><div class="plain" id="post-title">Android触摸事件分发</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-04-09</time></div><div class="article-container" id="post-content"><h1 id="1-触摸事件的类型"><a href="#1-触摸事件的类型" class="headerlink" title="1.触摸事件的类型"></a>1.触摸事件的类型</h1><p>对应的类是<code>MotionEvent</code>，主要有以下三个类型：</p>
<ul>
<li><strong>ACTION_DOWN</strong>：监听用户手指按下的操作，一次按下标志触摸事件的开始。</li>
<li><strong>ACTION_MOVE</strong>：用户按压屏幕后，在抬起之前，如果移动的距离超过一定数值，就判定为移动事件。</li>
<li><strong>ACTION_UP</strong>：监听用户手指离开屏幕的操作，一次抬起标志触摸事件的结束。</li>
<li><strong>ACTION_CANCEL</strong>：当用户保持按下操作，并把手指移动到了控件外部局域时且父View处理事件触发。</li>
</ul>
<h1 id="2-事件传递的三个阶段"><a href="#2-事件传递的三个阶段" class="headerlink" title="2.事件传递的三个阶段"></a>2.事件传递的三个阶段</h1><ul>
<li><p><strong>分发（Dispatch）</strong>：事件的分发对应着<code>dispatchTouchEvent</code>方法，所有触摸事件由这个方法进行分发</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span></span></span><br></pre></td></tr></table></figure>
<p>在这个方法中，根据当前视图的需求来进行事件的分发给子视图还是直接消费不往下传递，返回<code>true</code>表示事件被消费，不往下传递。返回值为<code>super.dispatchTouchEvent</code>表示继续往下传递。</p>
</li>
<li><p><strong>拦截（Intercept）</strong>:事件的拦截对应着<code>onInterceptTouchEvent</code>方法，这个事件只在ViewGroup及其子类中存在。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onInterceptTouchEvent</span><span class="params">(MotionEvent ev)</span></span></span><br></pre></td></tr></table></figure>
<p>根据具体的逻辑，返回<code>true</code>表示拦截该事件，不继续把事件分发给子视图，交由自身的<code>onTouchEvent</code>进行处理，返回值为<code>false或super.onInterceptTouchEvent</code>表示继续往下传递。</p>
</li>
<li><p><strong>消费（Consume）</strong>：事件的消费对应着<code>onTouchEvent</code>方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent ev)</span></span></span><br></pre></td></tr></table></figure>
<p>返回值为<code>true</code>时，表示当前视图可以处理事件，不会向上传递给父视图；返回值为<code>false</code>表示当前视图不处理这个事件，事件传递给父视图的<code>onTouchevent</code>进行处理。</p>
</li>
</ul>
<blockquote>
<p>在Android系统中，可以处理事件传递的类有以下三种：</p>
<ul>
<li><strong>Activity</strong>：包含<code>dispatchTouchEvent</code>，<code>onTouchEvent</code>方法</li>
<li><strong>ViewGroup</strong>：包含<code>dispatchTouchEvent</code>，<code>onInterceptTouchEvent</code>，<code>onTouchEvent</code></li>
<li><strong>View</strong>：包含<code>dispatchTouchEvent</code>，<code>onTouchEvent</code>方法</li>
</ul>
</blockquote>
<h1 id="3-View的事件传递机制"><a href="#3-View的事件传递机制" class="headerlink" title="3.View的事件传递机制"></a>3.View的事件传递机制</h1><p>View包括TextView，ImageView等子类，不包括ViewGroup。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Custom TextView with touchevent</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTextView</span> <span class="keyword">extends</span> <span class="title">AppCompatTextView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG=<span class="string">"MyTextView"</span>;</span><br><span class="line">    ...</span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_DOWN"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_UP"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_MOVE"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_CANCEL"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(event);②</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_DOWN"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_UP"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_MOVE"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_CANCEL"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onTouchEvent(event);④</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG=<span class="string">"MainActivity"</span>;</span><br><span class="line">    MyTextView mtv;</span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        mtv= (MyTextView) findViewById(R.id.mtv);</span><br><span class="line">        mtv.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">                Log.e(TAG,<span class="string">"MyTextView_onclick"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        mtv.setOnTouchListener(<span class="keyword">new</span> View.OnTouchListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View view, MotionEvent event)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">                    <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                        Log.e(TAG,<span class="string">"MyTextView_onTouch_ACTION_DOWN"</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">                        Log.e(TAG,<span class="string">"MyTextView_onTouch_ACTION_UP"</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                        Log.e(TAG,<span class="string">"MyTextView_onTouch_ACTION_MOVE"</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                        Log.e(TAG,<span class="string">"MyTextView_onTouch_ACTION_CANCEL"</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;③</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onUserInteraction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onUserInteraction();</span><br><span class="line">        Log.e(TAG,<span class="string">"onUserInteraction"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_DOWN"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_UP"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_MOVE"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_CANCEL"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(event);①</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_DOWN"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_UP"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_MOVE"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_CANCEL"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>常规输出：(返回的都为默认值)</p>
<ul>
<li>点击MyTextView区域</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_DOWN</span><br><span class="line">E/MyTextView: onTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_UP</span><br><span class="line">E/MyTextView: onTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: MyTextView_onclick</span><br></pre></td></tr></table></figure>
<ul>
<li>点击MyTextView外部区域</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: onTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_MOVE</span><br><span class="line">E/MainActivity: onTouchEvent_ACTION_MOVE</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: onTouchEvent_ACTION_UP</span><br></pre></td></tr></table></figure>
</li>
<li><p>① <strong>Activity的dispatchTouchEvent()</strong><code>return true;或return false;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_MOVE</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_MOVE</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_UP</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不会再继续分发触摸事件，及后续控件的触摸事件都不会响应。</p>
</blockquote>
</li>
<li><p>② <strong>View的dispatchTouchEvent()</strong><code>return true;</code>不会调用MyTextView的<code>onClick</code>事件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_DOWN</span><br><span class="line">E/MyTextView: onTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_UP</span><br><span class="line">E/MyTextView: onTouchEvent_ACTION_UP</span><br></pre></td></tr></table></figure>
<p><strong>View的dispatchTouchEvent()</strong><code>return false;</code>只响应MyTextView的<code>ACTION_DOWN</code>事件，后续的处理由MainActivity的<code>onTouchEvent</code>执行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: onTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_MOVE</span><br><span class="line">E/MainActivity: onTouchEvent_ACTION_MOVE</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: onTouchEvent_ACTION_UP</span><br></pre></td></tr></table></figure>
</li>
<li><p>③<strong>Activity中View的onTouch()</strong><code>return true;</code>不往下分发事件及不会调用到<code>onClick</code>事件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_DOWN</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_UP</span><br></pre></td></tr></table></figure>
</li>
<li><p>④ <strong>View的onTouchEvent()</strong><code>return true;</code>不触发<code>onClick</code>事件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_DOWN</span><br><span class="line">E/MyTextView: onTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_UP</span><br><span class="line">E/MyTextView: onTouchEvent_ACTION_UP</span><br></pre></td></tr></table></figure>
<p><strong>View的onTouchEvent()</strong><code>return false;</code>只响应MyTextView的<code>ACTION_DOWN</code>事件，后续的处理由MainActivity的<code>onTouchEvent</code>执行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_DOWN</span><br><span class="line">E/MyTextView: onTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: onTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: onTouchEvent_ACTION_UP</span><br></pre></td></tr></table></figure>
</li>
</ul>
<span itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="/images/study_plan/Activity-View dispatch.png" class="full-image" alt="View的事件传递" title="View的事件传递"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span>
<blockquote>
<p>总结：</p>
<ul>
<li><p>触摸事件传递从dispatchTouchEvent开始，在不修改默认返回的数值时，事件会按照嵌套层次由外向内传递，到达最内层的View时，就由它的onTouchEvent处理。</p>
</li>
<li><p>若事件在传递过程中，返回参数设为true，则导致事件提前被消费，内层View无法处理事件</p>
</li>
<li><p>View的事件触发顺序为先执行onTouch方法，最后执行onClick方法。onTouch返回false，则会响应onClick，否则事件不会继续传递。</p>
</li>
<li><p>View的点击事件流程：</p>
<p><strong>Activity.dispatchTouchEvent() -&gt; View.dispatchTouchEvent()-&gt;View.onTouch()-&gt;View.onTouchEvent()-&gt;View.onClick()</strong></p>
</li>
</ul>
</blockquote>
<h1 id="4-ViewGroup事件传递机制"><a href="#4-ViewGroup事件传递机制" class="headerlink" title="4.ViewGroup事件传递机制"></a>4.ViewGroup事件传递机制</h1><p>ViewGroup作为View的容器存在，ViewGroup包括LinearLayout，RelativeLayout等。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Custom ViewGroup with touchEvent</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRelativeLayout</span> <span class="keyword">extends</span> <span class="title">RelativeLayout</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG=<span class="string">"MyRelativeLayout"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyRelativeLayout</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyRelativeLayout</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_DOWN"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_UP"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_MOVE"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                Log.e(TAG,<span class="string">"dispatchTouchEvent_ACTION_CANCEL"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onInterceptTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                Log.e(TAG,<span class="string">"onInterceptTouchEvent_ACTION_DOWN"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">                Log.e(TAG,<span class="string">"onInterceptTouchEvent_ACTION_UP"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                Log.e(TAG,<span class="string">"onInterceptTouchEvent_ACTION_MOVE"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                Log.e(TAG,<span class="string">"onInterceptTouchEvent_ACTION_CANCEL"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onInterceptTouchEvent(event);⑥</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_DOWN"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_UP"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_MOVE"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                Log.e(TAG,<span class="string">"onTouchEvent_ACTION_CANCEL"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>常规模式（全为默认值）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyRelativeLayout: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyRelativeLayout: onInterceptTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_DOWN</span><br><span class="line">E/MyTextView: onTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MyRelativeLayout: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MyRelativeLayout: onInterceptTouchEvent_ACTION_UP</span><br><span class="line">E/MyTextView: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: MyTextView_onTouch_ACTION_UP</span><br><span class="line">E/MyTextView: onTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: MyTextView_onclick</span><br></pre></td></tr></table></figure>
</li>
<li><p>ViewGroup.onInterceptTouchEvent()返回true</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyRelativeLayout: dispatchTouchEvent_ACTION_DOWN</span><br><span class="line">E/MyRelativeLayout: onInterceptTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: MyRelativeLayoutonTouch_ACTION_DOWN</span><br><span class="line">E/MyRelativeLayout: onTouchEvent_ACTION_DOWN</span><br><span class="line">E/MainActivity: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MyRelativeLayout: dispatchTouchEvent_ACTION_UP</span><br><span class="line">E/MainActivity: MyRelativeLayout_onTouch_ACTION_UP</span><br><span class="line">E/MyRelativeLayout: onTouchEvent_ACTION_UP</span><br></pre></td></tr></table></figure>
</li>
</ul>
<span itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="/images/study_plan/Activity-ViewGroup-View dispatch.png" class="full-image" alt="View的事件传递" title="View的事件传递"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span>
<blockquote>
<p>总结:</p>
<ul>
<li><p>对于一个包裹在ViewGroup中的View，点击发生的触摸流程为：</p>
<p><strong>Activity.dispatchTouchEvent()-&gt;ViewGroup.dispatchTouchEvent()-&gt;ViewGroup.onInterceptTouchEvent()-&gt;View.dispatchTouchEvent()-&gt;View.onTouch()-&gt;View.onTouchEvent()-&gt;View.onClick()</strong></p>
</li>
<li><p>dispatchTouchEvent事件分发逻辑如下：</p>
<p>如果 return true，事件会分发给当前 View 并由 dispatchTouchEvent 方法进行消费，同时事件会停止向下传递；<br>如果 return false，事件分发分为两种情况：<br>1.如果当前 View 获取的事件直接来自 Activity，则会将事件返回给 Activity 的 onTouchEvent 进行消费；<br>2.如果当前 View 获取的事件来自外层父控件，则会将事件返回给父 View 的  onTouchEvent 进行消费。</p>
</li>
<li><p>onInterceptTouchEvent 的事件拦截逻辑如下：<br> 如果 onInterceptTouchEvent 返回 true，则表示将事件进行拦截，并将拦截到的事件交由当前 View 的 onTouchEvent 进行处理；<br>  如果 onInterceptTouchEvent 返回 false或super.onInterceptTouchEvent(ev)，则表示将事件放行，当前 View 上的事件会被传递到子 View 上，再由子 View 的 dispatchTouchEvent 来开始这个事件的分发；</p>
</li>
<li>onTouchEvent 的事件响应逻辑如下：<br>   如果事件传递到当前 View 的 onTouchEvent 方法，而该方法返回了 false，那么这个事件会从当前 View 向上传递，并且都是由上层 View 的 onTouchEvent 来接收，如果传递到上面的 onTouchEvent 也返回 false，这个事件就会“消失”，而且接收不到下一次事件。<br>   如果返回了 true 则会接收并消费该事件。<br>   如果返回 super.onTouchEvent(ev) 默认处理事件的逻辑和返回 false 时相同。</li>
</ul>
</blockquote>
<h1 id="5-源码分析"><a href="#5-源码分析" class="headerlink" title="5.源码分析"></a>5.源码分析</h1><p>//TODO</p>
<h1 id="6-实例分析"><a href="#6-实例分析" class="headerlink" title="6.实例分析"></a>6.实例分析</h1></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Leo-Wxy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://leo-wxy.github.io/2018/04/09/Android触摸事件分发/">https://leo-wxy.github.io/2018/04/09/Android触摸事件分发/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://leo-wxy.github.io">Wxy的个人博客</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Android/">Android</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/04/09/动态代理模式原理及实现/"><i class="fa fa-chevron-left">  </i><span>设计模式--静态代理模式和动态代理模式原理及实现</span></a></div><div class="next-post pull-right"><a href="/2018/04/07/热修复基本原理及其实现/"><span>热修复基本原理</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By Leo-Wxy</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>