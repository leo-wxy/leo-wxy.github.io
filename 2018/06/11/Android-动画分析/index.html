<!DOCTYPE html>
<html lang="zh-CN">





<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#9b868d">
  <meta name="description" content="如果我没有见过光明，那我本可以忍受黑暗">
  <meta name="author" content="Leo-Wxy">
  <meta name="keywords" content="">
  <title>Android-动画分析 - Wxy的个人博客</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css">


  <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/darcula.min.css">


<!-- 主题依赖的图标库，不要自行修改 -->
<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_fmb4a04yx8h.css">

<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">



<link rel="stylesheet" href="/css/main.css">

<!-- 自定义样式保持在最底部 -->


</head>


<body>
  <header style="height: 40vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Wxy's Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">
              <i class="iconfont icon-home-fill"></i>
              首页</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">
              <i class="iconfont icon-archive-fill"></i>
              归档</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">
              <i class="iconfont icon-tags-fill"></i>
              标签</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">
              <i class="iconfont icon-user-fill"></i>
              关于</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
                Android-动画分析
              
            </span>

            
              
                <div class="mt-3 post-meta">
                  <i class="iconfont icon-date-fill" aria-hidden="true"></i>
                  <time datetime="2018-06-11 09:39">
                    2018年6月11日 上午
                  </time>
                </div>
              

              <div class="mt-1">
                
                  
                  <span class="post-meta mr-2">
                    <i class="iconfont icon-chart"></i>
                    5.5k 字
                  </span>
                

                
                  
                  <span class="post-meta mr-2">
                      <i class="iconfont icon-clock-fill"></i>
                    
                    
                    75
                     分钟
                  </span>
                

                
              </div>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <blockquote>
<p>Android的动画就可以分为3种：</p>
<ul>
<li>View动画 <code>View Animation</code></li>
<li>帧动画 <code>Drawable Animation</code></li>
<li>属性动画 <code>Property Animation</code></li>
</ul>
</blockquote>
<h2 id="1-View动画"><a href="#1-View动画" class="headerlink" title="1.View动画"></a>1.View动画</h2><blockquote>
<p>View动画的作用对象是View。<strong>View动画的View移动只是视觉效果，并不能真正的改变位置。</strong></p>
</blockquote>
<h3 id="View动画的种类"><a href="#View动画的种类" class="headerlink" title="View动画的种类"></a>View动画的种类</h3><table>
<thead>
<tr>
<th>种类</th>
<th>标签</th>
<th>子类</th>
<th>效果</th>
</tr>
</thead>
<tbody>
<tr>
<td>平移动画</td>
<td><code>&lt;translate&gt;</code></td>
<td>TranslateAnimation</td>
<td>平移View</td>
</tr>
<tr>
<td>缩放动画</td>
<td><code>&lt;scale&gt;</code></td>
<td>ScaleAnimation</td>
<td>放大或者缩小View</td>
</tr>
<tr>
<td>旋转动画</td>
<td><code>&lt;rotate&gt;</code></td>
<td>RotateAnimation</td>
<td>旋转View</td>
</tr>
<tr>
<td>透明度动画</td>
<td><code>&lt;alpha&gt;</code></td>
<td>AlphaAnimation</td>
<td>View的透明度变化</td>
</tr>
</tbody>
</table>
<h3 id="使用View动画"><a href="#使用View动画" class="headerlink" title="使用View动画"></a>使用View动画</h3><p>要使用View动画，需要先创建动画的XML文件，这个文件的路径为<code>res/anim/animateFile.xml</code>。</p>
<div class="hljs"><pre><code class="hljs xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
<span class="hljs-tag">&lt;<span class="hljs-name">set</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:interpolator</span>=<span class="hljs-string">""</span>
    <span class="hljs-attr">android:shareInterpolator</span>=<span class="hljs-string">"[true | false]"</span>
    <span class="hljs-attr">android:fillAfter</span>=<span class="hljs-string">"true"</span>
    <span class="hljs-attr">android:duration</span>=<span class="hljs-string">'integar'</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">translate</span>
        <span class="hljs-attr">android:fromXDelta</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:toXDelta</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:fromYDelta</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:toYDelta</span>=<span class="hljs-string">"float"</span>/&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">scale</span>
        <span class="hljs-attr">android:fromXScale</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:toXScale</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:fromYScale</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:toYScale</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:pivotX</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:pivotY</span>=<span class="hljs-string">"float"</span>/&gt;</span>    
     <span class="hljs-tag">&lt;<span class="hljs-name">rotate</span>
        <span class="hljs-attr">android:fromDegrees</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:toDegrees</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:pivotY</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:pivotX</span>=<span class="hljs-string">"float"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">alpha</span> 
        <span class="hljs-attr">android:fromAlpha</span>=<span class="hljs-string">"float"</span>
        <span class="hljs-attr">android:toAlpha</span>=<span class="hljs-string">"float"</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span></code></pre></div>
<p><em>View动画既可以是单个动画，也可以由一系列动画组成。</em></p>
<p><code>&lt;set&gt;</code>：表示动画集合，对应<code>AnimationSet</code>，可以包含若干个动画，并且内部也可以嵌套其他动画集合。</p>
<ul>
<li><code>android:interpolator</code>：表示动画集合所采用的插值器，插值器会影响到动画的速度。</li>
<li><code>android:shareInterpolator</code>：是否共享插值器。<em>如果不指定，子动画就需要单独指定插值器或者使用默认值。</em></li>
<li><code>android:fillAfter</code>：表示动画结束时是否保持动画结束的状态。<code>false</code>回到动画初始样式</li>
<li><code>android:integar</code>：表示动画持续时长</li>
</ul>
<p><code>&lt;translate&gt;</code>：表示平移动画，对应<code>TranslateAnimation</code></p>
<ul>
<li><code>android:fromXDelta</code>：动画起始时X坐标上的位置。</li>
<li><code>android:toXDelta</code>：动画结束时X坐标上的位置。</li>
<li><code>android:fromYDelta</code>：动画起始时Y坐标上的位置。</li>
<li><code>android:toYDelta</code>：动画结束时Y坐标上的位置。</li>
</ul>
<blockquote>
<p>以上4个属性的取值可能为<code>数值，百分数，百分数P</code>，他们的含义有所区别：</p>
<p><code>数值</code>： 50 –&gt; 以View左上角为原点，向正方向偏移50px</p>
<p><code>百分数</code> 50% –&gt; 以View左上角为原点，向正方向偏移View宽/高的50%</p>
<p><code>百分数P</code> 50%P -&gt; 以View左上角为原点，向正方向偏移父布局(parent)宽/高的50%；</p>
</blockquote>
<p><code>&lt;scale&gt;</code>：表示缩放动画，对应<code>ScaleAnimation</code></p>
<ul>
<li><code>android:fromXScale</code>动画起始时水平方向伸缩值。 </li>
<li><code>android:toXScale</code>：动画结束时水平方向伸缩值。</li>
<li><code>android:fromYScale</code>：动画起始时竖直方向伸缩值。</li>
<li><code>android:toYScale</code>：动画结束时水平方向伸缩值。</li>
</ul>
<blockquote>
<p>以上4个属性的取值有不同的含义</p>
<p><code>值为0.0</code>  缩放比为0  代表缩放到原来的0 即消失</p>
<p><code>值&lt;1.0</code>  缩放比小于1 代表缩小</p>
<p><code>值为1.0</code> 缩放比等于1 代表与原来相同</p>
<p><code>值&gt;1.0</code> 缩放比大于1 代表放大</p>
</blockquote>
<ul>
<li><code>android:pivotX</code>：缩放轴点的X坐标。</li>
<li><code>android:pivotY</code>：缩放轴点的Y坐标。</li>
</ul>
<blockquote>
<p>以上两个属性表示 ，缩放的起始坐标，<strong>取值为%</strong>，<em>默认View的中心点，即50%,50%</em>。举个例子：如果<code>pivotX和pivotY</code>设置为0，即为左上角坐标，缩放时就是以左上角为原点向外向内。</p>
</blockquote>
<p><code>&lt;rotate&gt;</code>：表示旋转动画，对应<code>RotateAnimation</code></p>
<ul>
<li><code>android:fromDegrees</code>：动画起始时旋转的角度 。</li>
<li><code>android:toDegrees</code>：动画结束时旋转的角度。</li>
</ul>
<blockquote>
<p>以上两个属性共同确定旋转方向，原则是：当角度为<strong>负</strong>数时表示<strong>逆时针</strong>旋转，反之。</p>
<p>故共存在以下四种情况： </p>
<ul>
<li>from=负数 -&gt; to=正数：表示顺时针旋转</li>
<li>from=负数 -&gt;to =负数：表示逆时针旋转</li>
<li>from=正数 -&gt;to =正数：表示顺时针旋转</li>
<li>from=正数 -&gt;to=负数：表示逆时针旋转</li>
</ul>
</blockquote>
<ul>
<li><code>android:pivotX</code>：旋转轴点的X坐标。</li>
<li><code>android:pivotY</code>：旋转轴点的Y坐标。</li>
</ul>
<p><code>&lt;alpha&gt;</code>：表示透明度动画，对应<code>AlphaAnimation</code></p>
<ul>
<li><code>android:fromAlpha</code>：动画起始时透明度。</li>
<li><code>android:toAlpha</code>动画结束时透明度。</li>
</ul>
<blockquote>
<p>以上两个属性取值范围为 0~1</p>
<p><code>值&lt;=0</code> 代表完全透明</p>
<p><code>值&gt;=1</code> 代表完全不透明</p>
</blockquote>
<h3 id="应用代码"><a href="#应用代码" class="headerlink" title="应用代码"></a>应用代码</h3><blockquote>
<p>通过XML文件构建</p>
</blockquote>
<div class="hljs"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- animationset.xml --&gt;</span>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
<span class="hljs-tag">&lt;<span class="hljs-name">set</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:shareInterpolator</span>=<span class="hljs-string">"true"</span> &gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">translate</span>
        <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"2000"</span>
        <span class="hljs-attr">android:fromXDelta</span>=<span class="hljs-string">"0"</span>
        <span class="hljs-attr">android:fromYDelta</span>=<span class="hljs-string">"0"</span>
        <span class="hljs-attr">android:toXDelta</span>=<span class="hljs-string">"100%"</span>
        <span class="hljs-attr">android:toYDelta</span>=<span class="hljs-string">"100%"</span>&gt;</span> /&gt;
    <span class="hljs-tag">&lt;<span class="hljs-name">scale</span>
       <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"2000"</span>
       <span class="hljs-attr">android:fromXScale</span>=<span class="hljs-string">"1.0"</span>
       <span class="hljs-attr">android:fromYScale</span>=<span class="hljs-string">"1.0"</span>
       <span class="hljs-attr">android:pivotX</span>=<span class="hljs-string">"50%"</span>
       <span class="hljs-attr">android:pivotY</span>=<span class="hljs-string">"50%"</span>
       <span class="hljs-attr">android:toXScale</span>=<span class="hljs-string">"0.5"</span>
       <span class="hljs-attr">android:toYScale</span>=<span class="hljs-string">"0.5"</span> /&gt;</span> 
    <span class="hljs-tag">&lt;<span class="hljs-name">rotate</span>
        <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"2000"</span>
        <span class="hljs-attr">android:fromDegrees</span>=<span class="hljs-string">"0"</span>
        <span class="hljs-attr">android:toDegrees</span>=<span class="hljs-string">"360"</span>
        <span class="hljs-attr">android:pivotX</span>=<span class="hljs-string">"50%"</span>
        <span class="hljs-attr">android:pivotY</span>=<span class="hljs-string">"50%"</span>/&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">alpha</span>
       <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"2000"</span>
       <span class="hljs-attr">android:fromAlpha</span>=<span class="hljs-string">"1.0"</span>
       <span class="hljs-attr">android:toAlpha</span>=<span class="hljs-string">"0"</span>/&gt;</span>   
<span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span></code></pre></div>
<div class="hljs"><pre><code class="hljs java">Animation animation = AnimationUtils.loadAnimation(<span class="hljs-keyword">this</span>,R.anim.animationet);
view.startAnimation(animation);
animation.setAnimationListener(<span class="hljs-keyword">new</span> AnimationListener()&#123;
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationStart</span><span class="hljs-params">(Animation animation)</span></span>&#123;
    <span class="hljs-comment">//动画开始</span>
  &#125;
  
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationEnd</span><span class="hljs-params">(Animation animation)</span></span>&#123;
    <span class="hljs-comment">//动画结束</span>
  &#125;
  
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationRepeat</span><span class="hljs-params">(Animation animation)</span></span>&#123;
    <span class="hljs-comment">//动画重复 设置 android:repeatMode="[restart | reverse]" 时触发</span>
  &#125;
&#125;)</code></pre></div>
<blockquote>
<p>通过Java构建</p>
</blockquote>
<div class="hljs"><pre><code class="hljs java">AlphaAnimation alphaAnimation = <span class="hljs-keyword">new</span> AlphaAnimation(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
alphaAnimation.setDuration(<span class="hljs-number">2000</span>);

AnimationSet animationSet = <span class="hljs-keyword">new</span> AnimationSet(<span class="hljs-keyword">true</span>);
animationSet.addAnimation(alphaAnimation);

view.startAnimation(animationSet);</code></pre></div>
<h3 id="自定义View动画"><a href="#自定义View动画" class="headerlink" title="自定义View动画"></a>自定义View动画</h3><blockquote>
<p>自定义View动画是为了 实现系统提供的无法满足的动画情况，例如<code>3D翻转效果</code>，无法简单组合就能实现，就需要用到自定义View动画。</p>
</blockquote>
<p>实现步骤：<code>继承Animation -&gt; 重写initialize()以及applyTransformation()方法</code></p>
<ul>
<li><code>inltialize()</code>：初始化工作</li>
<li><code>allpyTransformation()</code>：进行相应的矩阵变换</li>
</ul>
<h4 id="自定义View动画实例"><a href="#自定义View动画实例" class="headerlink" title="自定义View动画实例"></a>自定义View动画实例</h4><p>TODO</p>
<h3 id="View动画特殊使用场景"><a href="#View动画特殊使用场景" class="headerlink" title="View动画特殊使用场景"></a>View动画特殊使用场景</h3><h4 id="1-LayoutAnimation"><a href="#1-LayoutAnimation" class="headerlink" title="1. LayoutAnimation"></a>1. LayoutAnimation</h4><blockquote>
<p>作用于ViewGroup，为ViewGroup指定一个动画，当它的子元素出场时都会具有这样的效果。</p>
</blockquote>
<div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">layoutAnimation</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
                 <span class="hljs-attr">android:delay</span>=<span class="hljs-string">""</span>
                 <span class="hljs-attr">android:animationOrder</span>=<span class="hljs-string">""</span>
                 <span class="hljs-attr">android:animation</span>=<span class="hljs-string">""</span> /&gt;</span></code></pre></div>
<p><code>android:delay</code>：表示子元素开始动画的延迟时间。</p>
<blockquote>
<p>比如，设置子元素入场动画的周期为 300ms，delay设置为0.5意味着，每个子元素都需要延迟150ms播放动画</p>
</blockquote>
<p><code>android:animationOrder</code> ：表示子元素动画的顺序</p>
<ul>
<li>normal 正序显示，按照排列顺序播放</li>
<li>random 随机显示</li>
<li>reverse 逆序显示</li>
</ul>
<p><code>android:animation</code>：表示设置的子元素动画</p>
<h5 id="应用代码-1"><a href="#应用代码-1" class="headerlink" title="应用代码"></a>应用代码</h5><blockquote>
<p>XML定义</p>
</blockquote>
<div class="hljs"><pre><code class="hljs xml">// anim_layout.xml
<span class="hljs-tag">&lt;<span class="hljs-name">layoutAnimation</span> 
    <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:animation</span>=<span class="hljs-string">"@anim/anim_layout_item"</span>
    <span class="hljs-attr">android:delay</span>=<span class="hljs-string">"0.5"</span>
    <span class="hljs-attr">android:animationOrder</span>=<span class="hljs-string">"normal"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">layoutAnimation</span>&gt;</span>

//anim_layout_item.xml
<span class="hljs-tag">&lt;<span class="hljs-name">set</span> 
    <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"500"</span>
    <span class="hljs-attr">android:shareInterpolator</span>=<span class="hljs-string">"true"</span>
    <span class="hljs-attr">android:interpolator</span>=<span class="hljs-string">"@android:anim/accelerate_interpolator"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">alpha</span>
        <span class="hljs-attr">android:fromAlpha</span>=<span class="hljs-string">"0"</span>
        <span class="hljs-attr">android:toAlpha</span>=<span class="hljs-string">"1"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scale</span>
        <span class="hljs-attr">android:fromXScale</span>=<span class="hljs-string">"1"</span>
        <span class="hljs-attr">android:toXScale</span>=<span class="hljs-string">"0"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">ListView</span> 
          <span class="hljs-attr">android:layoutAnimation</span> =<span class="hljs-string">"@anim/anim_layout"</span> /&gt;</span></code></pre></div>
<blockquote>
<p>Java代码生成</p>
</blockquote>
<div class="hljs"><pre><code class="hljs java">Animation animation = AnimationUtils.loadLayoutAnimation(<span class="hljs-keyword">this</span>, R.anim.anim_item);
        LayoutAnimationController controller = <span class="hljs-keyword">new</span> LayoutAnimationController(animation);<span class="hljs-comment">//对应android:animation属性</span>
        controller.setDelay(<span class="hljs-number">0.5</span>);<span class="hljs-comment">//对应android:delay属性      </span>
        controller.setOrder(LayoutAnimationController.ORDER_NORMAL);<span class="hljs-comment">//对应android:animationOrder属性</span>
        listView.setLayoutAnimation(controller);<span class="hljs-comment">//对应android:layoutAnimation属性</span></code></pre></div>
<h4 id="2-Activity切换效果"><a href="#2-Activity切换效果" class="headerlink" title="2.Activity切换效果"></a>2.Activity切换效果</h4><blockquote>
<p>Activity有默认的切换效果，是由系统自己定义的。需要自定义切换效果就需要用到<code>oberridePendingTransition(int inAnim,int outAnim)</code></p>
</blockquote>
<div class="hljs"><pre><code class="hljs xml">// enter_anim.xml
&lt;?xml version="1.0" encoding="utf-8"?&gt;  
<span class="hljs-tag">&lt;<span class="hljs-name">set</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>  
        <span class="hljs-attr">android:interpolator</span>=<span class="hljs-string">"@android:anim/decelerate_interpolator"</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">scale</span> <span class="hljs-attr">android:fromXScale</span>=<span class="hljs-string">"2.0"</span> <span class="hljs-attr">android:toXScale</span>=<span class="hljs-string">"1.0"</span>  
           <span class="hljs-attr">android:fromYScale</span>=<span class="hljs-string">"2.0"</span> <span class="hljs-attr">android:toYScale</span>=<span class="hljs-string">"1.0"</span>  
           <span class="hljs-attr">android:pivotX</span>=<span class="hljs-string">"50%p"</span> <span class="hljs-attr">android:pivotY</span>=<span class="hljs-string">"50%p"</span>  
           <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"@android:integer/config_mediumAnimTime"</span> /&gt;</span>  
<span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span>  

//exit_anim.xml
&lt;?xml version="1.0" encoding="utf-8"?&gt;  
<span class="hljs-tag">&lt;<span class="hljs-name">set</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>  
        <span class="hljs-attr">android:interpolator</span>=<span class="hljs-string">"@android:anim/decelerate_interpolator"</span>  
        <span class="hljs-attr">android:zAdjustment</span>=<span class="hljs-string">"top"</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">scale</span> <span class="hljs-attr">android:fromXScale</span>=<span class="hljs-string">"1.0"</span> <span class="hljs-attr">android:toXScale</span>=<span class="hljs-string">".5"</span>  
           <span class="hljs-attr">android:fromYScale</span>=<span class="hljs-string">"1.0"</span> <span class="hljs-attr">android:toYScale</span>=<span class="hljs-string">".5"</span>  
           <span class="hljs-attr">android:pivotX</span>=<span class="hljs-string">"50%p"</span> <span class="hljs-attr">android:pivotY</span>=<span class="hljs-string">"50%p"</span>  
           <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"@android:integer/config_mediumAnimTime"</span> /&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">alpha</span> <span class="hljs-attr">android:fromAlpha</span>=<span class="hljs-string">"1.0"</span> <span class="hljs-attr">android:toAlpha</span>=<span class="hljs-string">"0"</span>  
            <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"@android:integer/config_mediumAnimTime"</span>/&gt;</span>   
<span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span></code></pre></div>
<div class="hljs"><pre><code class="hljs java">Intent intent =<span class="hljs-keyword">new</span> Intent(<span class="hljs-keyword">this</span>,AnimActivity.class);
startActivityIntent(intent);
overridePendingTransition(R.anim.enter_anim,R.anim.exit_anim);
<span class="hljs-comment">//退出时设置</span>
finish();
overridePendingTransition(R.anim.enter_anim,R.anim.exit_anim);</code></pre></div>
<p><strong>该方法必须在<code>startActivity()</code>或者<code>finish()</code>之后调用才生效。</strong></p>
<h2 id="2-帧动画"><a href="#2-帧动画" class="headerlink" title="2.帧动画"></a>2.帧动画</h2><blockquote>
<p>帧动画是顺序播放一组预先定义好的图片，对应<code>AnimationDrawable</code></p>
</blockquote>
<div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">animation-list</span>  <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:oneshot</span>=<span class="hljs-string">"[true | false]"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">android:drawable</span>=<span class="hljs-string">""</span> <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"intreger"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">animation-list</span>&gt;</span></code></pre></div>
<p><code>android:oneshot</code>：表示是否播放一次</p>
<h3 id="应用代码-2"><a href="#应用代码-2" class="headerlink" title="应用代码"></a>应用代码</h3><blockquote>
<p>XML方式</p>
</blockquote>
<div class="hljs"><pre><code class="hljs xml">// animationlist.xml
<span class="hljs-tag">&lt;<span class="hljs-name">animation-list</span>  <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:oneshot</span>=<span class="hljs-string">"false"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">android:drawable</span>=<span class="hljs-string">"@drawable/bg1"</span> <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"500"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">android:drawable</span>=<span class="hljs-string">"@drawable/bg2"</span> <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"500"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">android:drawable</span>=<span class="hljs-string">"@drawable/bg3"</span> <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"500"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">android:drawable</span>=<span class="hljs-string">"@drawable/bg4"</span> <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"500"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">animation-list</span>&gt;</span></code></pre></div>
<div class="hljs"><pre><code class="hljs java">view.setBackgroundResource(R.drawable.animationlist);
AnimationDrawable animationDrawable = (AnimationDrawable)mView.getBackground();
animationDrawable.start();</code></pre></div>
<blockquote>
<p>Java生成</p>
</blockquote>
<div class="hljs"><pre><code class="hljs java">AnimationDrawable ad = <span class="hljs-keyword">new</span> AnimationDrawable();<span class="hljs-comment">//1.创建AnimationDrawable对象</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<span class="hljs-comment">//2.添加Drawable对象及其持续时间</span>
        Drawable drawable = getResources().getDrawable(getResources().getIdentifier(<span class="hljs-string">"bg"</span> + i, <span class="hljs-string">"drawable"</span>, getPackageName()));
        ad.addFrame(drawable, <span class="hljs-number">500</span>);
    &#125;
    ad.setOneShot(<span class="hljs-keyword">false</span>);<span class="hljs-comment">//3.设置是否执行一次</span>
    mView.setBackgroundResource(ad);<span class="hljs-comment">//4.将帧动画作为view背景</span>
    ad.start();<span class="hljs-comment">//5.播放动画</span></code></pre></div>
<p><strong>使用帧动画时要注意不能使用尺寸过大的图片。否则容易造成OOM错误</strong></p>
<h3 id="优化内存占用"><a href="#优化内存占用" class="headerlink" title="优化内存占用"></a>优化内存占用</h3><blockquote>
<p>由于图片全部是从xml中读取的，一定要全部读取下来动画才可以开始，因为要不断地替换图片去实现动画效果。一次性取出所有图片，就容易导致OOM</p>
</blockquote>
<p>优化思路：<strong>一次只取一个图片，开启一个线程去取下一张，达到一致的效果。</strong></p>
<h2 id="3-属性动画"><a href="#3-属性动画" class="headerlink" title="3.属性动画"></a>3.属性动画</h2><blockquote>
<p>对作用对象进行了扩展，可以对任何对象做动画，甚至可以没有对象。</p>
</blockquote>
<h3 id="1-与View动画进行比较"><a href="#1-与View动画进行比较" class="headerlink" title="1. 与View动画进行比较"></a>1. 与View动画进行比较</h3><ul>
<li>View动画的作用对象<code>只能是View</code>，属性动画可以作用于<code>所有Java对象</code></li>
<li>View动画并没有改变View的属性，只是改变了View的视觉效果，并不具有交互性(<em>例如：无法响应动画后的点击事件。</em>)；属性动画是真正的对View的属性进行了修改，可以方便后续的交互操作。</li>
<li>View动画的效果比较单一，只能实现一些<code>平移，缩放，旋转等简单动画效果</code>，复杂的效果可能就需要<code>自定义View动画</code>去实现；属性动画拓展性强，可以基本实现所有的动画效果。</li>
</ul>
<h3 id="2-使用属性动画"><a href="#2-使用属性动画" class="headerlink" title="2.使用属性动画"></a>2.使用属性动画</h3><blockquote>
<p>使用XML方式</p>
</blockquote>
<div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">set</span>
  <span class="hljs-attr">android:ordering</span>=<span class="hljs-string">[</span>"<span class="hljs-attr">together</span>" | "<span class="hljs-attr">sequentially</span>"]&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">objectAnimator</span>
        <span class="hljs-attr">android:propertyName</span>=<span class="hljs-string">"string"</span>
        <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"int"</span>
        <span class="hljs-attr">android:valueFrom</span>=<span class="hljs-string">"float | int | color"</span>
        <span class="hljs-attr">android:valueTo</span>=<span class="hljs-string">"float | int | color"</span>
        <span class="hljs-attr">android:startOffset</span>=<span class="hljs-string">"int"</span>
        <span class="hljs-attr">android:repeatCount</span>=<span class="hljs-string">"int"</span>
        <span class="hljs-attr">android:repeatMode</span>=<span class="hljs-string">[</span>"<span class="hljs-attr">repeat</span>" | "<span class="hljs-attr">reverse</span>"]
        <span class="hljs-attr">android:valueType</span>=<span class="hljs-string">[</span>"<span class="hljs-attr">intType</span>" | "<span class="hljs-attr">floatType</span>"]/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">animator</span>
        <span class="hljs-attr">android:duration</span>=<span class="hljs-string">"int"</span>
        <span class="hljs-attr">android:valueFrom</span>=<span class="hljs-string">"float | int | color"</span>
        <span class="hljs-attr">android:valueTo</span>=<span class="hljs-string">"float | int | color"</span>
        <span class="hljs-attr">android:startOffset</span>=<span class="hljs-string">"int"</span>
        <span class="hljs-attr">android:repeatCount</span>=<span class="hljs-string">"int"</span>
        <span class="hljs-attr">android:repeatMode</span>=<span class="hljs-string">[</span>"<span class="hljs-attr">repeat</span>" | "<span class="hljs-attr">reverse</span>"]
        <span class="hljs-attr">android:valueType</span>=<span class="hljs-string">[</span>"<span class="hljs-attr">intType</span>" | "<span class="hljs-attr">floatType</span>"]/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span></code></pre></div>
<p><code>&lt;set&gt;</code>：表示动画集合，对应<code>AnimatorSet</code></p>
<p><code>android:ordering</code>：表示子动画的播放顺序</p>
<ul>
<li><code>together</code>：子动画同时播放</li>
<li><code>sequentially</code>：子动画按照定义顺序先后播放</li>
</ul>
<h4 id="使用ObjectAnimator实现"><a href="#使用ObjectAnimator实现" class="headerlink" title="使用ObjectAnimator实现"></a>使用<code>ObjectAnimator</code>实现</h4><blockquote>
<p>XML方式</p>
</blockquote>
<p><code>&lt;objectAnimator&gt;</code>：对象动画，对应<code>ObjectAnimator</code></p>
<ul>
<li><p><code>android:propertyName</code>：属性动画作用的属性名称</p>
<p>| 属性         | 作用                   | 数值类型 |<br>| ———— | ———————- | ——– |<br>| alpha        | 控制View的透明度       | float    |<br>| translationX | 控制View的水平方向位移 | float    |<br>| translationY | 控制View的竖直方向位移 | float    |<br>| rotation     | 控制View的Z轴旋转度数  | float    |<br>| rotationX    | 控制View的X轴旋转度数  | float    |<br>| rotationY    | 控制View的Y轴旋转度数  | float    |<br>| scaleX       | 控制View的X轴缩放倍数  | float    |<br>| scaleY       | 控制View的Y轴缩放倍数  | float    |</p>
</li>
<li><p><code>android:duration</code>： 动画持续时长。</p>
</li>
<li><p><code>android:startOffset</code>：设置动画执行之前的等待时长。</p>
</li>
<li><p><code>android:repeatCount</code>：动画重复执行的次数。</p>
<ul>
<li>默认为<strong>0</strong>，表示只播放一次。</li>
<li>设置为<strong>-1或infinite</strong>，表示无限重复。</li>
</ul>
</li>
<li><p><code>android:repeatMode</code>：动画重复执行的模式。可选值：</p>
<ul>
<li><strong>restart</strong>：表示连续重复，为默认值。</li>
<li><strong>reverse</strong> ：表示逆向重复。</li>
</ul>
</li>
<li><p><code>android:valueFrom</code>：动画初始值。</p>
</li>
<li><p><code>android:valueTo</code>：动画结束值。</p>
</li>
<li><p><code>android:valueType</code>：动画值类型。可选值：</p>
<ul>
<li>intType：表示属性的类型为 整形</li>
<li>floatType：表示属性的类型为浮点型 <em>默认值</em></li>
<li>不设置：如果表示颜色，无需设置</li>
</ul>
</li>
</ul>
<blockquote>
<p>Java创建</p>
</blockquote>
<div class="hljs"><pre><code class="hljs java">ObjectAnimator mObjectAnimator = ObjectAnimator.ofFloat(view,propertyName<span class="hljs-comment">/*对应属性操作，可以为任意值*/</span>,<span class="hljs-keyword">float</span>... values<span class="hljs-comment">/*动画的初始值以及结束值，不定长度*/</span>);

mObjectAnimator.setDuration(duration);
mObjectAnimator.setStartDelay(delay);
mObjectAnimator.setRepeatCount(repeatCount);
mObjectAnimator.setRepeatMode(repeatMode);
mObjectAnimator.start();</code></pre></div>
<h5 id="应用代码-3"><a href="#应用代码-3" class="headerlink" title="应用代码"></a>应用代码</h5><blockquote>
<p>XML方式</p>
</blockquote>
<div class="hljs"><pre><code class="hljs xml">// objectAnim.xml
<span class="hljs-tag">&lt;<span class="hljs-name">objectAnimator</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>  
    <span class="hljs-attr">android:valueFrom</span>=<span class="hljs-string">"1"</span>   // 初始值
    <span class="hljs-attr">android:valueTo</span>=<span class="hljs-string">"0"</span>  // 结束值
    <span class="hljs-attr">android:valueType</span>=<span class="hljs-string">"floatType"</span>  // 变化值类型 ：<span class="hljs-attr">floatType</span> &amp; <span class="hljs-attr">intType</span>
    <span class="hljs-attr">android:propertyName</span>=<span class="hljs-string">"alpha"</span> // 对象变化的属性名称

/&gt;</span></code></pre></div>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">// 载入XML动画</span>
Animator animator = AnimatorInflater.loadAnimator(context, R.animator.objectAnim);  
<span class="hljs-comment">// 设置执行动画对象</span>
animator.setTarget(view);  
animator.start();</code></pre></div>
<blockquote>
<p>Java方式</p>
</blockquote>
<div class="hljs"><pre><code class="hljs java">ObjectAnimator mObjectAnimator = ObjectAnimator.ofFloat(view,<span class="hljs-string">"alpha"</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);

mObjectAnimator.setDuration(<span class="hljs-number">1000</span>);
mObjectAnimator.setStartDelay(<span class="hljs-number">100</span>);
mObjectAnimator.setRepeatCount(<span class="hljs-number">0</span>);
mObjectAnimator.setRepeatMode(ValueAnimator.RESTART);
mObjectAnimator.start();</code></pre></div>
<h4 id="使用ValueAnimator实现"><a href="#使用ValueAnimator实现" class="headerlink" title="使用ValueAnimator实现"></a>使用<code>ValueAnimator</code>实现</h4><p><code>&lt;animator&gt;</code>：对应<code>ValueAnimator</code></p>
<p>相比于<code>&lt;objectAnimator&gt;</code>少了一个<code>android:propertyName</code>，其他含义相同。</p>
<blockquote>
<p>Java创建</p>
</blockquote>
<div class="hljs"><pre><code class="hljs java">ValueAnimator anim = ValueAnimator.ofInt(<span class="hljs-keyword">int</span>... values);
<span class="hljs-comment">//ValueAnimator anim = ValueAnimator.ofFloat(float... values);</span>
<span class="hljs-comment">//ValueAnimator anim = ValueAnimator.ofObject(TypeEvaluator evaluator, Object... values);</span>

anim.setDuration(duration);
anim.setStartDelay(delay);
anim.setRepeatCount(repeatCount);
anim.setRepeatMode(repeatMode);
anim.start();</code></pre></div>
<h5 id="应用代码-4"><a href="#应用代码-4" class="headerlink" title="应用代码"></a>应用代码</h5><div class="hljs"><pre><code class="hljs java">ValueAnimator anim = ValueAnimator.ofInt(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>);
        <span class="hljs-comment">// 设置动画运行的时长</span>
        anim.setDuration(<span class="hljs-number">500</span>);       
        <span class="hljs-comment">// 设置动画延迟播放时间</span>
        anim.setStartDelay(<span class="hljs-number">500</span>);
        <span class="hljs-comment">// 设置动画重复播放次数 = 重放次数+1    </span>
        anim.setRepeatCount(<span class="hljs-number">0</span>); 
        anim.setRepeatMode(ValueAnimator.RESTART);
        anim.addUpdateLinstener(<span class="hljs-keyword">new</span> ValueAnimator.AnimatorUpdateListener()&#123;
  				<span class="hljs-meta">@Override</span>
  				<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationUpdate</span><span class="hljs-params">(ValueAnimator animation)</span></span>&#123;
    				<span class="hljs-keyword">int</span> currentValue = (Integer)animation.getAnimatedValue；
            <span class="hljs-comment">//在其中对View进行相关属性设置 利用currentValue</span>
              ...
            view.requestLayout();
  				&#125;
				&#125;)
        anim.start();</code></pre></div>
<h4 id="使用动画集合AnimatiorSet实现"><a href="#使用动画集合AnimatiorSet实现" class="headerlink" title="使用动画集合AnimatiorSet实现"></a>使用动画集合<code>AnimatiorSet</code>实现</h4><blockquote>
<p>利用集合类<code>AnimatorSet</code>，内部可以随意组合继承<code>Animator类</code>的子类，而且可以定制顺序。</p>
</blockquote>
<h5 id="应用代码-5"><a href="#应用代码-5" class="headerlink" title="应用代码"></a>应用代码</h5><div class="hljs"><pre><code class="hljs java">
<span class="hljs-comment">// 平移动画</span>
ObjectAnimator translation = ObjectAnimator.ofFloat(mButton, <span class="hljs-string">"translationX"</span>, curTranslationX, <span class="hljs-number">300</span>,curTranslationX);  
<span class="hljs-comment">// 旋转动画</span>
ObjectAnimator rotate = ObjectAnimator.ofFloat(mButton, <span class="hljs-string">"rotation"</span>, <span class="hljs-number">0f</span>, <span class="hljs-number">360f</span>);  
<span class="hljs-comment">// 透明度动画</span>
ObjectAnimator alpha = ObjectAnimator.ofFloat(mButton, <span class="hljs-string">"alpha"</span>, <span class="hljs-number">1f</span>, <span class="hljs-number">0f</span>, <span class="hljs-number">1f</span>);  

AnimatorSet animSet = <span class="hljs-keyword">new</span> AnimatorSet();  
<span class="hljs-comment">// 设置动画执行顺序</span>
animSet.play(translation).with(rotate).before(alpha);  
animSet.setDuration(<span class="hljs-number">5000</span>);  
animSet.start();</code></pre></div>
<h4 id="使用ViewPropertyAnimator实现"><a href="#使用ViewPropertyAnimator实现" class="headerlink" title="使用ViewPropertyAnimator实现"></a>使用<code>ViewPropertyAnimator</code>实现</h4><blockquote>
<p>专门针对VIew操作的属性动画，可以直接由view进行调用，相当于一个简单的实现方式。</p>
</blockquote>
<h5 id="应用代码-6"><a href="#应用代码-6" class="headerlink" title="应用代码"></a>应用代码</h5><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//设置View 透明度以及平移</span>
view.animate().alpha(<span class="hljs-number">0</span>).translationX(<span class="hljs-number">100</span>).setDuration(<span class="hljs-number">500</span>).start();</code></pre></div>
<h3 id="3-理解插值器和估值器"><a href="#3-理解插值器和估值器" class="headerlink" title="3.理解插值器和估值器"></a>3.理解插值器和估值器</h3><h4 id="1-插值器-Interpolator"><a href="#1-插值器-Interpolator" class="headerlink" title="1.插值器(Interpolator)"></a>1.插值器(<code>Interpolator</code>)</h4><blockquote>
<p>根据时间流逝的百分比计算出当前属性值改变的百分比。确定了动画效果变化的模式，如匀速变化、加速变化等。</p>
</blockquote>
<p>系统内部预置了一些常用的插值器：</p>
<ul>
<li><code>LinearInterpolator</code> : 线性插值器 - 匀速运动</li>
<li><code>AccelerateDecelerateInterpolator</code>：加速减速插值器 - 两头慢中间快</li>
<li><code>DecelerateInterpolator</code>：减速插值器 - 越来越慢</li>
</ul>
<p>可以应用的对象：</p>
<ul>
<li>View动画： 上文有提到，对应设置属性为<code>android:interpolator</code></li>
<li>属性动画：实现<em>非匀速运动</em>的方法</li>
</ul>
<p>自定义插值器：</p>
<blockquote>
<p>可以高度定制化自己需要的运行轨迹。</p>
</blockquote>
<p>实现：需要实现<code>Interpolator/TimeInterpolator</code>接口并复写<code>getInterpolation()</code>方法。</p>
<blockquote>
<ol>
<li>补间动画 实现 <code>Interpolator</code>接口；属性动画实现<code>TimeInterpolator</code>接口</li>
<li><code>TimeInterpolator</code>接口是属性动画中新增的，用于兼容<code>Interpolator</code>接口，这使得所有过去的<code>Interpolator</code>实现类都可以直接在属性动画使用。</li>
</ol>
</blockquote>
<p>接口说明：</p>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">TimeInterpolator</span> </span>&#123;    
    <span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">getInterpolation</span><span class="hljs-params">(<span class="hljs-keyword">float</span> input)</span></span>;  
&#125;  

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Interpolator</span> <span class="hljs-keyword">extends</span>  <span class="hljs-title">TimeInterpolator</span></span>&#123;  
&#125;

input 变化范围为<span class="hljs-number">0</span>~<span class="hljs-number">1</span> 
返回值<span class="hljs-keyword">float</span>型的  用于估值器计算的</code></pre></div>
<p>实现示例：<em>自定义插值器的关键在于<code>input</code>根据动画的进度(0%~100%)通过逻辑计算，得到当前属性值改变的百分比。</em></p>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DecelerateAccelerateInterpolator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">TimeInterpolator</span> </span>&#123;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> <span class="hljs-title">getInterpolation</span><span class="hljs-params">(<span class="hljs-keyword">float</span> input)</span> </span>&#123;
        <span class="hljs-keyword">float</span> result;
        <span class="hljs-keyword">if</span> (input &lt;= <span class="hljs-number">0.5</span>) &#123;
            result = (<span class="hljs-keyword">float</span>) (Math.sin(Math.PI * input)) / <span class="hljs-number">2</span>;
        &#125; <span class="hljs-keyword">else</span> &#123;
            result = (<span class="hljs-keyword">float</span>) (<span class="hljs-number">2</span> - Math.sin(Math.PI * input)) / <span class="hljs-number">2</span>;
        &#125;
        <span class="hljs-keyword">return</span> result;
    &#125;</code></pre></div>
<h4 id="2-估值器-Evaluator"><a href="#2-估值器-Evaluator" class="headerlink" title="2.估值器(Evaluator)"></a>2.估值器(<code>Evaluator</code>)</h4><blockquote>
<p>根据当前属性改变的百分比来计算改变后的属性值</p>
</blockquote>
<p>系统提供了一些估值器：</p>
<ul>
<li><code>IntEvaluator</code>：整形估值器</li>
<li><code>FloatEvaluator</code>：浮点型估值器</li>
<li><code>ArgbEvaluator</code>：Color属性估值器</li>
</ul>
<p>可以应用的对象：</p>
<p><strong>属性动画专属</strong></p>
<p>使用方法：</p>
<div class="hljs"><pre><code class="hljs java">ValueAnimator anim = ValueAnimator.ofInt(<span class="hljs-keyword">int</span>... values);  <span class="hljs-comment">//使用的是 IntEvaluator</span>
ValueAnimator anim = ValueAnimator.ofFloat(<span class="hljs-keyword">float</span>... values); <span class="hljs-comment">//使用的是 FloatEvaluator</span>
ValueAnimator anim = ValueAnimator.ofArgb(<span class="hljs-keyword">int</span>... values);<span class="hljs-comment">// 使用的是 ArgbEvaluator</span>
<span class="hljs-comment">//需要自定义 估值器</span>
ValueAnimator anim = ValueAnimator.ofObject(TypeEvaluator evaluator, Object... values);</code></pre></div>
<p>自定义估值器：</p>
<blockquote>
<p>除了<code>int,float,color</code>类型之外的类型做动画，需要用到自定义估值器</p>
</blockquote>
<p>接口说明：</p>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">TypeEvaluator</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;
    <span class="hljs-comment">/**
    * <span class="hljs-doctag">@param</span> fraction   估值小数 插值器的返回值
    * <span class="hljs-doctag">@param</span> startValue 起始值
    * <span class="hljs-doctag">@param</span> endValue   结束值
    */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">evaluate</span><span class="hljs-params">(<span class="hljs-keyword">float</span> fraction, T startValue, T endValue)</span></span>;
&#125;</code></pre></div>
<p>实现实例：</p>
<p>先定义自定义对象</p>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Point</span> </span>&#123;
    <span class="hljs-comment">// 设置两个变量用于记录坐标的位置</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> x;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> y;

    <span class="hljs-comment">// 构造方法用于设置坐标</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Point</span><span class="hljs-params">(<span class="hljs-keyword">float</span> x, <span class="hljs-keyword">float</span> y)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.x = x;
        <span class="hljs-keyword">this</span>.y = y;
    &#125;

    <span class="hljs-comment">// get方法用于获取坐标</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> <span class="hljs-title">getX</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> x;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> <span class="hljs-title">getY</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> y;
    &#125;
&#125;</code></pre></div>
<p>定义估值器</p>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PointEvaluator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">TypeEvaluator</span>&lt;<span class="hljs-title">Point</span>&gt; </span>&#123;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Point <span class="hljs-title">evaluate</span><span class="hljs-params">(<span class="hljs-keyword">float</span> fraction, Point startValue, Point endValue)</span> </span>&#123;
        <span class="hljs-keyword">float</span> x = startValue.getX() + fraction * (endValue.getX() - startValue.getX());
        <span class="hljs-keyword">float</span> y = startValue.getY() + fraction * (endValue.getY() - startValue.getY());
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Point(x, y);
    &#125;
&#125;</code></pre></div>
<p>使用估值器</p>
<div class="hljs"><pre><code class="hljs java">Point startPoint = <span class="hljs-keyword">new</span> Point(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>);<span class="hljs-comment">// 初始点为圆心(100, 100)</span>
Point endPoint = <span class="hljs-keyword">new</span> Point(<span class="hljs-number">300</span>, <span class="hljs-number">300</span>);<span class="hljs-comment">// 结束点为(300, 300)</span>
ValueAnimator anim = ValueAnimator.ofObject(<span class="hljs-keyword">new</span> PointEvaluator(), startPoint, endPoint);
anim.setDuration(<span class="hljs-number">5000</span>);
anim.start();</code></pre></div>
<h3 id="4-属性动画监听器"><a href="#4-属性动画监听器" class="headerlink" title="4.属性动画监听器"></a>4.属性动画监听器</h3><blockquote>
<p>可以监听属性动画的播放过程，包括<code>起始，结束，取消，重复</code>。</p>
</blockquote>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AnimatorListener</span> </span>&#123;
  <span class="hljs-comment">//动画开始</span>
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationStart</span><span class="hljs-params">(Animation animation)</span></span>;
  <span class="hljs-comment">//动画结束</span>
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationEnd</span><span class="hljs-params">(Animation animation)</span></span>;
  <span class="hljs-comment">//动画取消</span>
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationCancel</span><span class="hljs-params">(Animation animation)</span></span>;
  <span class="hljs-comment">//动画重复</span>
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationRepeat</span><span class="hljs-params">(Animation animation)</span></span>;
&#125;

调用方式
animator.addListener(<span class="hljs-keyword">new</span> AnimatorListener()&#123;
 ...
&#125;)；</code></pre></div>
<p>拓展：</p>
<h4 id="AnimatorListenerAdapter：AnimatorListener的适配器类，主要为了解决实现接口繁琐的问题。在大多数情况下，我们可能只要监听动画的开始和结束事件。如果直接继承AnimatorListener接口，就需要实现额外的方法。"><a href="#AnimatorListenerAdapter：AnimatorListener的适配器类，主要为了解决实现接口繁琐的问题。在大多数情况下，我们可能只要监听动画的开始和结束事件。如果直接继承AnimatorListener接口，就需要实现额外的方法。" class="headerlink" title="AnimatorListenerAdapter：AnimatorListener的适配器类，主要为了解决实现接口繁琐的问题。在大多数情况下，我们可能只要监听动画的开始和结束事件。如果直接继承AnimatorListener接口，就需要实现额外的方法。"></a><code>AnimatorListenerAdapter</code>：<code>AnimatorListener</code>的适配器类，主要为了解决<strong>实现接口繁琐</strong>的问题。在大多数情况下，我们可能只要监听动画的开始和结束事件。如果直接继承<code>AnimatorListener</code>接口，就需要实现额外的方法。</h4><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnimatorListenerAdapter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Animator</span>.<span class="hljs-title">AnimatorListener</span>,
        <span class="hljs-title">Animator</span>.<span class="hljs-title">AnimatorPauseListener</span> </span>&#123;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationCancel</span><span class="hljs-params">(Animator animation)</span> </span>&#123;
    &#125;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationEnd</span><span class="hljs-params">(Animator animation)</span> </span>&#123;
    &#125;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationRepeat</span><span class="hljs-params">(Animator animation)</span> </span>&#123;
    &#125;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationStart</span><span class="hljs-params">(Animator animation)</span> </span>&#123;
    &#125;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationPause</span><span class="hljs-params">(Animator animation)</span> </span>&#123;
    &#125;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationResume</span><span class="hljs-params">(Animator animation)</span> </span>&#123;
    &#125;
&#125;

使用方式
animator.addListener(<span class="hljs-keyword">new</span> AnimatorListenerAdapter()&#123;
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationStart</span><span class="hljs-params">(Animator animation)</span> </span>&#123;
      <span class="hljs-comment">//只实现开始监听</span>
    &#125;
&#125;)</code></pre></div>
<h4 id="AnimatorUpdateListener：监听整个动画过程，每播放一帧，就会回调一次。"><a href="#AnimatorUpdateListener：监听整个动画过程，每播放一帧，就会回调一次。" class="headerlink" title="AnimatorUpdateListener：监听整个动画过程，每播放一帧，就会回调一次。"></a><code>AnimatorUpdateListener</code>：监听整个动画过程，每播放一帧，就会回调一次。</h4><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AnimatorUpdateListener</span> </span>&#123;
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationUpdate</span><span class="hljs-params">(ValueAnimator animation)</span>；
&#125;</span></code></pre></div>
<p>利用这个特性，我们可以去对得到的数据进行处理。</p>
<p>上文中，自定义估值器，我们设置了一个<code>Point</code>对象，它的动画过程就是<code>Point</code>对象内部<code>x,y</code>变化的过程，我们就可以利用这个接口实时的去获取内部<code>x,y</code>进行操作。利用<code>ValueAnimator.getAnimatedValue()</code>就可以获取到对应的对象。</p>
<h3 id="5-对任意属性做动画"><a href="#5-对任意属性做动画" class="headerlink" title="5.对任意属性做动画"></a>5.对任意属性做动画</h3><p>上文中我们提到<code>android:propertyName</code>里面填的就是 属性动画可以支持的属性，假如我们要对View的宽度做动画，应该如何实现？</p>
<p><strong>属性动画的原理：属性动画要求动画作用的对象必须提供该属性的<code>get()和set()</code>方法，属性动画根据外界传递的该属性的初始值和结束值，以动画的效果多次去调用<code>set()</code>，每次传入的值不一样，随着时间推移，会越来越接近结束值。</strong></p>
<p>根据上述原理，我们可以得出一个结果。要想动画生效，必须支持两个条件：</p>
<ul>
<li><code>Object</code>必须提供<code>set()</code>，如果动画没有传递初始值，那么还要提供<code>get()</code>，因为系统要去获取初始值，计算最终值。（<em>不满足则直接Crash</em>）</li>
<li><code>Object</code>设置的<code>set()</code>必须可以让View产生变化，比如UI上会发生变化。(<em>不满足则不会发生变化</em>)</li>
</ul>
<p>针对上述条件，可以有3种解决方法：</p>
<ol>
<li><h4 id="给你的对象加上get-set-，如果你有权限的话"><a href="#给你的对象加上get-set-，如果你有权限的话" class="headerlink" title="给你的对象加上get(),set()，如果你有权限的话"></a>给你的对象加上<code>get(),set()</code>，如果你有权限的话</h4><blockquote>
<p>继承原始类，直接给继承类加上<code>get(),set()</code>，从而实现给对象加上该属性的<code>get(),set()</code></p>
</blockquote>
</li>
<li><h4 id="用一个类来包装原始对象，间接提供get-set"><a href="#用一个类来包装原始对象，间接提供get-set" class="headerlink" title="用一个类来包装原始对象，间接提供get(),set()"></a>用一个类来包装原始对象，间接提供<code>get(),set()</code></h4><blockquote>
<p>本质上是采用了设计模式中的装饰模式，即通过包装拓展对象的功能。</p>
</blockquote>
<p>示例：一开始就提到了对View的宽度进行动画效果，用这种方案就是找一个类来进行包装。</p>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnimActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Activity</span> </span>&#123;
  ImageView imageView;
  ViewWrapper wrapper;
  
  <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>&#123;
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        imageView = (ImageView) findViewById(R.id.imageView);        
        <span class="hljs-comment">// 创建包装类,并传入动画作用的对象</span>
        wrapper = <span class="hljs-keyword">new</span> ViewWrapper(imageView);        
        imageView.setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() &#123;
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>&#123;
                ObjectAnimator.ofInt(wrapper, <span class="hljs-string">"width"</span><span class="hljs-comment">/*对应我们设置的getWidth()和setWidth()*/</span>, <span class="hljs-number">500</span>).setDuration(<span class="hljs-number">3000</span>).start();
            &#125;
        &#125;);
    &#125;
  
    <span class="hljs-comment">// 提供ViewWrapper类,用于包装View对象</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ViewWrapper</span> </span>&#123;
        <span class="hljs-keyword">private</span> View mTarget;

        <span class="hljs-comment">// 构造方法:传入需要包装的对象</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ViewWrapper</span><span class="hljs-params">(View target)</span> </span>&#123;
            mTarget = target;
        &#125;

        <span class="hljs-comment">// 为宽度设置get（） &amp; set（）</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getWidth</span><span class="hljs-params">()</span> </span>&#123;
            <span class="hljs-keyword">return</span> mTarget.getLayoutParams().width;
        &#125;

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setWidth</span><span class="hljs-params">(<span class="hljs-keyword">int</span> width)</span> </span>&#123;
            mTarget.getLayoutParams().width = width;
            <span class="hljs-comment">//对View重新布局</span>
            mTarget.requestLayout();
        &#125;
    &#125;
&#125;</code></pre></div>
</li>
<li><h4 id="采用ValueAnimator，监听动画过程，利用返回值动态调整View属性"><a href="#采用ValueAnimator，监听动画过程，利用返回值动态调整View属性" class="headerlink" title="采用ValueAnimator，监听动画过程，利用返回值动态调整View属性"></a>采用<code>ValueAnimator</code>，监听动画过程，利用返回值动态调整View属性</h4><blockquote>
<p><code>ValueAnimator</code>本身不作用于任何对象，直接使用它不会有任何效果。做到的就是对一个View的属性进行变化。在动画过程中修改属性值，就类似于对对象做了动画。</p>
</blockquote>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnimActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Activity</span></span>&#123;
  <span class="hljs-meta">@Override</span>
  <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span></span>&#123;
    setContentView(R.layout.main);
    view.post(<span class="hljs-keyword">new</span> Runnable()&#123;
      <span class="hljs-meta">@Override</span>
      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span>&#123;
        performAnimator(view,view.getWidth,<span class="hljs-number">500</span>);
      &#125;
    &#125;)
  &#125;
  
  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">performAnimatior</span><span class="hljs-params">(<span class="hljs-keyword">final</span> View target,<span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> start,<span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> end)</span></span>&#123;
    ValueAnimator valueAnimator = ValueAnimator.ofInt(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>);
    valueAnimator.addUpdateListener(<span class="hljs-keyword">new</span> AnimatorUpdateListener()&#123;
       <span class="hljs-keyword">private</span> IntEvaluator mEvaluator = <span class="hljs-keyword">new</span> IntEvaluator();
       <span class="hljs-meta">@Override</span>
      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onAnimationUpdate</span><span class="hljs-params">(ValueAnimator animator)</span></span>&#123;
        <span class="hljs-keyword">int</span> currentValue = (Integer)animator.getAnimatedValue();
        <span class="hljs-keyword">float</span> fraction = animator.getAnimatedFraction();
        target.getLayoutParams().width = mEvaluator.evaluate(fraction,start,end);
        target.requestLayout();
      &#125;
    &#125;);
    valueAnimator.setDuration(<span class="hljs-number">5000</span>).start();
  &#125;
&#125;</code></pre></div>
</li>
</ol>
<h3 id="6-属性动画工作原理"><a href="#6-属性动画工作原理" class="headerlink" title="6.属性动画工作原理"></a>6.属性动画工作原理</h3><blockquote>
<p>属性动画要求动画作用的对象必须提供该属性的<code>set()</code>方法，属性动画就会根据你传递的该属性的初始值和最终值，以动画的效果多次去调用<code>set()</code>。每次传递给<code>set()</code>的值都不一样，确切的来说是随着时间的推移，传递的值越来越接近最终值。如果动画不提供初始值，那就需要定义<code>get()</code>，以供系统去获取初始值。</p>
</blockquote>
<p>接下来就从入口处开始分析。</p>
<p><code>ObjectAnimator.ofFloat(view,&quot;alpha&quot;,0f,1f).start()</code>意味着动画开始。</p>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">// ../android/animation/ObjectAnimator.java</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">start</span><span class="hljs-params">()</span> </span>&#123;
  <span class="hljs-comment">//如果动画已经执行，则停止动画</span>
  AnimationHandler.getInstace().autoCancelBasedOn(<span class="hljs-keyword">this</span>);
  <span class="hljs-keyword">super</span>.start()
&#125;</code></pre></div>
<p><code>super.start()</code>就调用到父类<code>ValueAnimator.start()</code></p>
<div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">// ../android/animation/ValueAnimator.java</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">start</span><span class="hljs-params">()</span></span>&#123;
  start(<span class="hljs-keyword">false</span>);
&#125;

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">start</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> playBackwards)</span> </span>&#123;
        <span class="hljs-keyword">if</span> (Looper.myLooper() == <span class="hljs-keyword">null</span>) &#123;
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AndroidRuntimeException(<span class="hljs-string">"Animators may only be run on Looper threads"</span>);
        &#125;
        mReversing = playBackwards;
        mSelfPulse = !mSuppressSelfPulseRequested;
        <span class="hljs-comment">// Special case: reversing from seek-to-0 should act as if not seeked at all.</span>
        <span class="hljs-keyword">if</span> (playBackwards &amp;&amp; mSeekFraction != -<span class="hljs-number">1</span> &amp;&amp; mSeekFraction != <span class="hljs-number">0</span>) &#123;
            <span class="hljs-keyword">if</span> (mRepeatCount == INFINITE) &#123;
                <span class="hljs-comment">// Calculate the fraction of the current iteration.</span>
                <span class="hljs-keyword">float</span> fraction = (<span class="hljs-keyword">float</span>) (mSeekFraction - Math.floor(mSeekFraction));
                mSeekFraction = <span class="hljs-number">1</span> - fraction;
            &#125; <span class="hljs-keyword">else</span> &#123;
                mSeekFraction = <span class="hljs-number">1</span> + mRepeatCount - mSeekFraction;
            &#125;
        &#125;
        mStarted = <span class="hljs-keyword">true</span>;
        mPaused = <span class="hljs-keyword">false</span>;
        mRunning = <span class="hljs-keyword">false</span>;
        mAnimationEndRequested = <span class="hljs-keyword">false</span>;
        mLastFrameTime = -<span class="hljs-number">1</span>;
        mFirstFrameTime = -<span class="hljs-number">1</span>;
        mStartTime = -<span class="hljs-number">1</span>;
        addAnimationCallback(<span class="hljs-number">0</span>);

        <span class="hljs-keyword">if</span> (mStartDelay == <span class="hljs-number">0</span> || mSeekFraction &gt;= <span class="hljs-number">0</span> || mReversing) &#123;
            startAnimation();
            <span class="hljs-keyword">if</span> (mSeekFraction == -<span class="hljs-number">1</span>) &#123;
                setCurrentPlayTime(<span class="hljs-number">0</span>);
            &#125; <span class="hljs-keyword">else</span> &#123;
                setCurrentFraction(mSeekFraction);
            &#125;
        &#125;
    &#125;</code></pre></div>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Android/">Android</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2018/06/12/Android-Study-Plan-XIX/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Android-Study-Plan-XIX</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2018/06/03/数据结构-树/">
                        <span class="hidden-mobile">数据结构-树</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>






<!-- Plugins -->





  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>


















</body>
</html>
