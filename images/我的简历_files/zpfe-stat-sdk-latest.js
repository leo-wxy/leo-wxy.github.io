/*!
* @zpfe/stat-sdk@1.0.0-beta.30
* (c) 2018-2019 zhaopin.com
*/
var _zpStat=function(){"use strict";var o=!1;var r={getCookies:function(){var e={};try{for(var t=document.cookie?document.cookie.split("; "):[],r=0;r<t.length;r++){var n=t[r].split("=");e[n[0]]=decodeURIComponent(n[1])}return e}catch(t){return console.error("获取 cookies 失败",t),window.zpStat&&window.zpStat.error&&window.zpStat.error(t,"获取 cookies 失败"),e}},getCurrentUrlPath:function(t){var e="";return"string"==typeof t&&(e=t.replace(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/,"$3/$5")),e},copyMembers:function(t,e){if(e)for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},addEventListener:function(t,e,r){t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent("on"+e,r)},removeEventListener:function(t,e,r){t.removeEventListener?t.removeEventListener(e,r):t.detachEvent("on"+e,r)}};function n(){var t=window.zpStatConfig||(window.zpStatConfig={});return!t.page&&(t.page={}),t}function a(t){var e=r.getCookies();e.at&&e.rt&&(t.passport_at=e.at,t.passport_rt=e.rt)}var e={get:function(){var t,e=n();return t=e.page,window.zpPageRequestId&&(t.x_zp_page_request_id=window.zpPageRequestId),t.current_url=document.location.href,t.current_url_path=r.getCurrentUrlPath(document.location.href),t.referrer=document.referrer,t.appid||console.error("请配置zpStatConfig.page.appid"),a(t),e},refresh:function(){var t=n();t.page.referrer=t.page.current_url,t.page.current_url=document.location.href,a(t.page)}},i=e.get(),c="sa";function s(t){try{var e=t.getAttribute("zp-stat-id");if(!e)return{};for(var r={stat_id:e},n=t.attributes,o=0;o<n.length;o++){var a=n[o].name;"zp-stat-id"!==a&&(0==a.indexOf("zp-stat-")&&(r[a=a.substr(8).replace(/-/g,"_")]=n[o].value))}return r.track&&window.zpStat&&window.zpStat.track&&window.zpStat.track(r.track,r),r}catch(t){return window.zpStat&&window.zpStat.error&&window.zpStat.error(t.message,"提取自定义上报信息失败"),{}}}(function(t){try{var e=t.sdk_url,r=t.name,n=window,o=document,a=null,i=null;n.sensorsDataAnalytic201505=r,n[r]=n[r]||function(t){return function(){(n[r]._q=n[r]._q||[]).push([t,arguments])}};for(var c=["track","quick","register","registerPage","registerOnce","trackSignup","trackAbtest","setProfile","setOnceProfile","appendProfile","incrementProfile","deleteProfile","unsetProfile","identify","login","logout","trackLink","clearAllRegister","getAppStatus"],s=0;s<c.length;s++)n[r][c[s]]=n[r].call(null,c[s]);n[r]._t||(a=o.createElement("script"),i=o.getElementsByTagName("script")[0],a.async=1,a.src=e,a.setAttribute("charset","UTF-8"),i.parentNode.insertBefore(a,i),n[r].para=t)}catch(t){console.error("神策SDK默认初始化错误",t)}})(function(){var t=function(){var t={A1:"zlbusiness",A:"zlclient",B:"highpin",E1:"zlcrm",E:"itoa",F:"production",G14:"zlclient",G:"production",H:"zlclient",J:"zlbschool",K:"hremail",L:"production"};if(o)return"default";var e=i.page.appid,r=e.substr(0,2),n=e.substr(0,1);return t[e]?t[e]:t[r]?t[r]:t[n]?t[n]:"default"}(),e={sdk_url:"https://statistic.zhaopin.cn/sdk/sa/1.12.6/sa.min.js",heatmap_url:"https://statistic.zhaopin.cn/sdk/sa/1.12.6/heap_map.min.js",name:c,show_log:!!o,web_url:"https://dsm.zhaopin.cn/?project="+t,server_url:"https://ds.zhaopin.cn/sa?project="+t,heatmap:{custom_property:s}};r.copyMembers(e,i.sa);try{void 0!==window.localStorage&&void 0!==window.localStorage.zpfe_stat_sa_show_log&&(e.show_log="true"===window.localStorage.getItem("zpfe_stat_sa_show_log"))}catch(t){}return e}()),window[c].registerPage&&window[c].registerPage(i.page),!0!==i.isSPA&&window[c].quick&&window[c].quick("autoTrack");var p=r.getCurrentUrlPath;function u(t){return window.sa&&window.sa[t]}window.zpStat={track:function(t,e,r){u("track")&&window.sa.track(t,e,r)},login:function(t){u("login")&&window.sa.login(t)},logout:function(t){u("logout")&&window.sa.logout(t)},setProfile:function(t,e){u("setProfile")&&window.sa.setProfile(t,e)},error:function(t,e){t&&(console.error(e,t),u("track")&&window.sa.track("zp_ui_error",{zp_ui_error_message:t.message,zp_ui_error_stack:t.stack,zp_ui_error_description:e,current_url_path:p(document.location.href)}))},refreshPageConfig:function(){u("track")&&window.sa.registerPage(window.zpStatConfig&&window.zpStatConfig.page)},switchPage:function(){var t=this;u("quick")&&setTimeout(function(){e.refresh(),t.refreshPageConfig(),window.sa.quick("autoTrackSinglePage")},100)}};!function(){var t=window.XMLHttpRequest;if(t){var i=t.prototype.open;t.prototype.open=function(){for(var t=window.zpPageRequestId,e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var o=r[1],a=o;try{t&&(a+=(-1<o.indexOf("?")?"&":"?")+"x-zp-page-request-id="+t),r[1]=a,i.apply(this,r)}catch(t){console.error("执行 XMLHttpRequest open 出错",t),window.zpStat&&window.zpStat.error&&window.zpStat.error(t,"执行 XMLHttpRequest open 出错")}}}}();r.addEventListener(window,"error",function(t){var e;(e=t).error&&e.error.stack&&-1!=e.error.stack.indexOf(".zhaopin.c")&&(window.zpStat&&window.zpStat.error?window.zpStat.error(t.error,"发现未捕获的错误"):console.error("发现未捕获的错误",t.error))});var d=3e4;function w(t,e){var r=Math.abs(parseInt(e-t));return d<r&&(r=0),r}r.addEventListener(window,"load",function(){var t=function(){if(!window.performance||!window.performance.timing)return null;var t=window.performance.timing,e=w(t.redirectStart,t.redirectEnd),r=w(t.domainLookupStart,t.domainLookupEnd),n=w(t.connectStart,t.connectEnd),o=w(t.requestStart,t.responseStart),a=w(t.responseStart,t.responseEnd),i=w(t.navigationStart,t.domContentLoadedEventEnd),c=w(t.navigationStart,t.responseStart),s=w(t.domInteractive,t.domComplete),p=w(t.navigationStart,t.domComplete);return{zp_performance_redirect:e,zp_performance_domain_lookup:r,zp_performance_tcp:n,zp_performance_request:o,zp_performance_response:a,zp_performance_dom_content_load:i,zp_performance_response_start:c,zp_performance_dom_processing:s,zp_performance_dom_complete:p}}();t&&window.zpStat.track("zp_ui_performance",t)});return{}}();
